---
title: 'Tutorial: Image Extraction'
description: 'Use Aryn DocParse to extract an image from a battery manual'
icon: 'image'
---

## Introduction

In [this example](https://drive.google.com/file/d/1eyBIc_oiAn0LvoP2uHBluJJp1N3onxRz/view?usp=sharing), we'll use DocParse to extract an image from a battery manual. We'll go through the important code snippets below to see what's going on.

Let's focus on the following code that makes a call to Aryn DocParse API to extract the image from the PDF:
  
```python extract_image.py
import aryn_sdk
from aryn_sdk.partition import partition_file, tables_to_pandas
import pandas as pd
from io import BytesIO

aryn_api_key = 'YOUR-KEY-HERE'
file_name = 'powerwall_parts_boards.pdf'

# Parse the file extracting images,
# extracting inline text embedded in the PDF,
# and using Aryn's default table extraction model.
with open(file_name, 'rb') as file:
  partitioned_file = partition_file(file, aryn_api_key=aryn_api_key,
                                    extract_images=True,
                                    table_mode="standard",
                                    text_mode="inline")

```


If you inspect the partitioned_file variable, you'll notice that it's a large JSON object with details about all the components in the PDF (checkout [this page](../output_structure) to understand the schema of the returned JSON object in detail). Below, we highlight an `Image` element that contains the information about some of the images in the page: 

```json docparse_output.json
[
  {'type': 'Image',
 'bbox': [0.9439504825367647,
  0.005599567673423073,
  0.9984484145220588,
  0.058024385625665836],
 'properties': {'score': 0.6607702374458313,
  'image_size': [112, 136],
  'image_mode': 'RGB',
  'image_format': None,
  'page_number': 1},
 'binary_representation': ...
  }
]
```

## Extracting the Image

This JSON object represents one of the images in the PDF. You'll notice that the image's binary representation, its bounding box (which indicates the coordinates of the image in the PDF), and certain other properties (image_mode, image_size etc.) are returned back. You can then process this JSON however you'd like for further analysis. In the notebook, we use the Pillow Image module from python to display the extracted image on its own. Let's take a look at the JSON object for a schematic image in the PDF.

```json image_output.json
{'type': 'Image',
 'bbox': [0.07296839545754825,
  0.11070712002840909,
  0.3344818833295037,
  0.44303000710227275],
 'properties': {'score': 0.8690586090087891,
  'image_size': [465, 751],
  'image_mode': 'RGB',
  'image_format': None,
  'page_number': 1},
 'binary_representation': ...
}
```

Now, let's extract the image from the JSON object and display it.

```python image_output.py
## extract all the images from the JSON and print out the JSON representation of the first image
images = [e for e in partitioned_file['elements'] if e['type'] == 'Image']
first_image = images[0]

## read in the image and display it
image_width = first_image['properties']['image_size'][0]
image_height = first_image['properties']['image_size'][1]
image_mode = first_image['properties']['image_mode']
image = Image.frombytes(image_mode,  (image_width, image_height), base64.b64decode(first_image['binary_representation']))

#display the image
image 
```

## Output Image

Here's the output image after extraction. As you can see, the image has been successfully extracted from the PDF with clarity.

<Frame>
  <img src="/images/board.png" />
</Frame>


## Captions

If you want to associate captions with the images, you can set the `associate_captions` parameter to `True`.

```python
partitioned_file = partition_file(file, aryn_api_key, extract_images=True, image_extraction_options={'associate_captions': True})
```

After enabling the `associate_captions` parameter, you'll notice that the image is now associated with a caption, as seen below.

<Frame>
  <img src="/images/image_with_caption.png" />
</Frame>

The caption is also returned in the `caption` field of the image or table element.

```json image_output.json
{'type': 'Image',
 'bbox': [0.07296839545754825,
  0.11070712002840909,
  0.3344818833295037,
  0.44303000710227275],
 'properties': {'score': 0.8690586090087891,
  'image_size': [465, 751],
  'image_mode': 'RGB',
  'image_format': None,
  'caption': {'type': 'Caption',
   'bbox': [0.07958163990693934,
    0.418170859596946,
    0.32795234231387865,
    0.44303000710227275],
   'properties': {'score': 0.4383608400821686,
    '_element_index': 19,
    'font_size': 8.04000000000002},
   'text_representation': 'Install Fuse and Connect Main Service Conductors'},
  'page_number': 1},
 'binary_representation': ...
}
```